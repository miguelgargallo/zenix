---
import Tag from "../components/Tag.astro";
import Ga from "../components/Ga.astro";
import BaseHead from "../components/BaseHead.astro";
import ApiHeader from "../components/ApiHeader.astro";
import Footer from "../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION, AUTHOR } from "../config";
---

<html lang="en">
  <head>
    <Tag />
  </head>
  <div>
    <ash>
      <BaseHead
        title={SITE_TITLE}
        description={SITE_DESCRIPTION}
        author={AUTHOR}
      />
    </ash>
  </div>

  <body>
    <Ga />
    <ApiHeader />
    <p>
      <!-- Display unicorn emoji in broswers in ascii -->

      Welcome to the magic world of Handshake
    </p>
  </body>
  <div>
    <form id="form" action="#" method="post">
      <p>Your Wallet | Don't touch this! |</p>
      <input type="hidden" name="title" value="New issue" />
      <input type="text" name="wallet" placeholder="hns wallet" />
      <input
        type="text"
        name="api"
        placeholder="api"
        value="cil"
        disabled
        hidden
      />
      <input type="text" name="domain" placeholder="domain" />
      <input type="submit" value="Submit" />
    </form>

    <script>
      function updateApiField() {
        const apiField = document.querySelector('input[name="api"]');
        apiField.value =
          "cil" +
          Math.random().toString(36).substring(2, 15) +
          Math.random().toString(36).substring(2, 15) +
          Math.random().toString(36).substring(2, 16) +
          Math.random().toString(36).substring(2, 12);
      }

      function getRandomTitle(domain) {
        const titles = [
          `[Domain] Add .${domain} to this f* awesome registry ðŸ”¥ðŸ”¥ðŸ”¥`,
          `[Domain] Eth suc* ðŸ’§ðŸ’§ðŸ’§ add .${domain} to this amazing world of HNS`,
          `[Domain] H A N D S H A K E and my tld .${domain} ðŸš€ðŸš€ðŸš€ rocks`,
          `[Domain] HNS is the future, add .${domain} to this registry`,
          `[Domain] WHY NOT .${domain} ðŸ¤·â€â™‚ï¸ðŸ¤·â€â™‚ï¸ðŸ¤·â€â™‚ï¸ on Handshake registry`,
          `[Domain] Add .${domain} to Handshake, âœ¨âœ¨âœ¨ it's awesome`,
        ];
        const index = Math.floor(Math.random() * titles.length);
        return titles[index];
      }

      const form = document.querySelector("#form");
      form.addEventListener("submit", (event) => {
        event.preventDefault();

        const wallet = document.querySelector('input[name="wallet"]').value;
        const api = document.querySelector('input[name="api"]').value;
        const domain = document.querySelector('input[name="domain"]').value;
        const body = `Wallet: ${wallet}\nAPI: ${api}\nDomain: ${domain}`;
        const title = getRandomTitle(domain);
        const url = `https://github.com/miguelgargallo/Blog/issues/new?title=${encodeURIComponent(
          title
        )}&body=${encodeURIComponent(body)}`;
        window.open(url, "_blank");
      });

      updateApiField();
    </script>
  </div>
  <Footer />
</html>
